{"version":3,"file":"dist/harb.min.js","sources":["harb.js"],"names":["HARB","make_harb","version","exports","module","babyParse","require","cptable","ssf","fs","datenum","v","date1904","epoch","Date","parse","UTC","sheet_to_workbook","sheet","SheetNames","Sheets","Sheet1","aoa_to_sheet","data","opts","ws","range","s","c","r","e","R","length","C","cell","cell_ref","encode_cell","t","z","_table","encode_range","bpopts","dynamicTyping","keepEmptyRows","csv_to_aoa","str","d","dt","getDate","csv_to_sheet","csv_to_workbook","prn_to_sheet","f","Error","prn_to_workbook","dif_to_aoa","records","split","ri","arr","trim","metadata","type","value","substr","dif_to_sheet","dif_to_workbook","sylk_to_aoa","rj","record","RT","val","charAt","parseInt","j","sylk_to_sheet","sylk_to_workbook","socialcalc_to_aoa","addr","decode_cell","socialcalc_to_sheet","socialcalc_to_workbook","sc_to_sheet","sc_to_workbook","read","indexOf","readFile","o","b","readFileSync","utils","decode","slice","toString","decode_row","rowstr","encode_row","row","decode_col","colstr","i","charCodeAt","encode_col","col","Math","floor","String","fromCharCode","split_cell","cstr","replace","splt","cs","ce"],"mappings":"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"}