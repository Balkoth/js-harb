{"version":3,"file":"dist/harb.min.js","sources":["harb.js"],"names":["HARB","make_harb","version","exports","module","babyParse","require","cptable","ssf","fs","datenum","v","date1904","epoch","Date","parse","UTC","numdate","date","parse_date_code","val","setUTCDate","d","setUTCMonth","m","setUTCFullYear","y","setUTCHours","H","setUTCMinutes","M","setUTCSeconds","S","sheet_to_workbook","sheet","SheetNames","Sheets","Sheet1","aoa_to_sheet","data","opts","ws","range","s","c","r","e","R","length","C","cell","cell_ref","encode_cell","t","z","_table","encode_range","bpopts","dynamicTyping","keepEmptyRows","csv_to_aoa","str","dt","getDate","csv_to_sheet","csv_to_workbook","prn_to_sheet","f","Error","prn_to_workbook","dif_to_aoa","records","split","ri","arr","trim","metadata","type","value","substr","dif_to_sheet","dif_to_workbook","sylk_to_aoa","rj","formats","next_cell_format","record","RT","charAt","push","parseInt","j","match","sylk_to_sheet","sylk_to_workbook","socialcalc_to_aoa","addr","decode_cell","socialcalc_to_sheet","socialcalc_to_workbook","sc_to_sheet","sc_to_workbook","read","indexOf","readFile","o","b","readFileSync","utils","decode","slice","toString","decode_row","rowstr","encode_row","row","decode_col","colstr","i","charCodeAt","encode_col","col","Math","floor","String","fromCharCode","split_cell","cstr","replace","splt","cs","ce"],"mappings":"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"}