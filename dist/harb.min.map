{"version":3,"file":"dist/harb.min.js","sources":["harb.js"],"names":["HARB","make_harb","version","exports","module","babyParse","require","cptable","ssf","fs","datenum","v","date1904","epoch","Date","parse","UTC","sheet_to_workbook","sheet","SheetNames","Sheets","Sheet1","aoa_to_sheet","data","opts","ws","range","s","c","r","e","R","length","C","cell","cell_ref","encode_cell","t","z","_table","encode_range","bpopts","dynamicTyping","keepEmptyRows","csv_to_aoa","str","d","dt","getDate","csv_to_sheet","csv_to_workbook","prn_to_sheet","f","Error","prn_to_workbook","dif_to_aoa","records","split","ri","arr","trim","metadata","type","value","substr","dif_to_sheet","dif_to_workbook","sylk_to_sheet","sylk_to_workbook","socialcalc_to_aoa","record","addr","decode_cell","socialcalc_to_sheet","socialcalc_to_workbook","sc_to_sheet","sc_to_workbook","read","indexOf","readFile","o","b","readFileSync","utils","decode","slice","toString","decode_row","rowstr","parseInt","encode_row","row","decode_col","colstr","i","charCodeAt","encode_col","col","Math","floor","String","fromCharCode","split_cell","cstr","replace","splt","cs","ce"],"mappings":"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"}