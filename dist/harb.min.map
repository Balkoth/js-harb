{"version":3,"file":"dist/harb.min.js","sources":["harb.js"],"names":["HARB","make_harb","version","exports","module","babyParse","require","cptable","ssf","fs","datenum","v","date1904","epoch","Date","parse","UTC","numdate","date","parse_date_code","val","setUTCDate","d","setUTCMonth","m","setUTCFullYear","y","setUTCHours","H","setUTCMinutes","M","setUTCSeconds","S","sheet_to_workbook","sheet","SheetNames","Sheets","Sheet1","aoa_to_sheet","data","opts","ws","range","s","c","r","e","R","length","C","cell","cell_ref","encode_cell","t","z","_table","encode_range","bpopts","dynamicTyping","keepEmptyRows","csv_to_aoa","str","csv_to_sheet","csv_to_workbook","prn_to_sheet","f","Error","prn_to_workbook","dif_to_aoa","records","split","ri","arr","trim","metadata","type","value","substr","dif_to_sheet","dif_to_workbook","sylk_to_aoa","rj","formats","next_cell_format","record","RT","charAt","push","parseInt","j","match","sylk_to_sheet","sylk_to_workbook","socialcalc_to_aoa","addr","decode_cell","socialcalc_to_sheet","socialcalc_to_workbook","sc_to_sheet","sc_to_workbook","read","hint","indexOf","readFile","o","b","readFileSync","utils","decode","slice","toString","decode_row","rowstr","encode_row","row","decode_col","colstr","i","charCodeAt","encode_col","col","Math","floor","String","fromCharCode","split_cell","cstr","replace","splt","cs","ce"],"mappings":";AAGA,GAAIA,UACJ,QAAUC,WAAWD,MACrBA,KAAKE,QAAU,OACf,UAAWC,WAAY,YAAa,CACnC,SAAWC,UAAW,aAAeA,OAAOD,QAAS,CACpDE,UAAYC,QAAQ,YACpBC,SAAUD,QAAQ,iBAClBE,KAAMF,QAAQ,MACdG,IAAKH,QAAQ,OAIf,QAASI,SAAQC,EAAGC,UACnB,GAAGA,SAAUD,GAAG,IAChB,IAAIE,OAAQC,KAAKC,MAAMJ,EACvB,QAAQE,MAAQ,GAAIC,MAAKA,KAAKE,IAAI,KAAM,GAAI,OAAS,GAAK,GAAK,GAAK,KAGrE,QAASC,SAAQN,GAChB,GAAIO,MAAOV,IAAIW,gBAAgBR,EAC/B,IAAIS,KAAM,GAAIN,KACdM,KAAIC,WAAWH,KAAKI,EACpBF,KAAIG,YAAYL,KAAKM,EAAE,EACvBJ,KAAIK,eAAeP,KAAKQ,EACxBN,KAAIO,YAAYT,KAAKU,EACrBR,KAAIS,cAAcX,KAAKY,EACvBV,KAAIW,cAAcb,KAAKc,EACvB,OAAOZ,KAGR,GAAIa,mBAAoB,SAAUC,OAAS,OAAQC,YAAa,UAAWC,QAASC,OAAQH,QAE5F,SAASI,cAAaC,KAAMC,MAC3B,GAAIC,MACJ,IAAIC,QAASC,GAAIC,EAAE,IAAUC,EAAE,KAAWC,GAAIF,EAAE,EAAGC,EAAE,GACrD,KAAI,GAAIE,GAAI,EAAGA,GAAKR,KAAKS,SAAUD,EAAG,CACrC,IAAI,GAAIE,GAAI,EAAGA,GAAKV,KAAKQ,GAAGC,SAAUC,EAAG,CACxC,GAAGP,MAAMC,EAAEE,EAAIE,EAAGL,MAAMC,EAAEE,EAAIE,CAC9B,IAAGL,MAAMC,EAAEC,EAAIK,EAAGP,MAAMC,EAAEC,EAAIK,CAC9B,IAAGP,MAAMI,EAAED,EAAIE,EAAGL,MAAMI,EAAED,EAAIE,CAC9B,IAAGL,MAAMI,EAAEF,EAAIK,EAAGP,MAAMI,EAAEF,EAAIK,CAC9B,IAAIC,OAAQvC,EAAG4B,KAAKQ,GAAGE,GACvB,IAAGC,KAAKvC,GAAK,KAAM,QACnB,IAAIwC,UAAWC,aAAaR,EAAEK,EAAEJ,EAAEE,GAClC,UAAUG,MAAKvC,IAAM,SAAUuC,KAAKG,EAAI,QACnC,UAAUH,MAAKvC,IAAM,UAAWuC,KAAKG,EAAI,QACzC,IAAGH,KAAKvC,YAAaG,MAAM,CAC/BoC,KAAKG,EAAI,GAAKH,MAAKI,EAAI9C,IAAI+C,OAAO,GAClCL,MAAKvC,EAAID,QAAQwC,KAAKvC,OAElBuC,MAAKG,EAAI,GACdZ,IAAGU,UAAYD,MAGjB,GAAGR,MAAMC,EAAEC,EAAI,IAAUH,GAAG,QAAUe,aAAad,MACnD,OAAOD,IAGR,GAAIgB,SACHC,cAAe,KACfC,cAAe,KAEhB,IAAIC,YAAa,SAAUC,KAC1B,GAAItB,MAAOlC,UAAUU,MAAM8C,IAAKJ,QAAQlB,IACxC,KAAI,GAAIQ,GAAE,EAAGA,GAAKR,KAAKS,SAAUD,EAAG,IAAI,GAAIE,GAAE,EAAGA,GAAKV,KAAKQ,GAAGC,SAAUC,EAAG,CAC1E,GAAI3B,GAAIiB,KAAKQ,GAAGE,EAChB,IAAG3B,IAAM,GAAIiB,KAAKQ,GAAGE,GAAK,SACrB,IAAG3B,IAAM,OAAQiB,KAAKQ,GAAGE,GAAK,SAC9B,IAAG3B,IAAM,QAASiB,KAAKQ,GAAGE,GAAK,MAErC,MAAOV,MAGR,IAAIuB,cAAe,SAAUD,KAAO,MAAOvB,cAAasB,WAAWC,MAEnE,IAAIE,iBAAkB,SAAUF,KAAO,MAAO5B,mBAAkB6B,aAAaD,MAE7E,IAAIG,cAAe,SAASC,GAAK,KAAM,IAAIC,OAAM,yBAEjD,IAAIC,iBAAkB,SAAUN,KAAO,MAAO5B,mBAAkB+B,aAAaH,MAE7E,IAAIO,YAAa,SAAUP,KAC1B,GAAIQ,SAAUR,IAAIS,MAAM,MAAOvB,GAAK,EAAGE,GAAK,EAAGsB,GAAK,EAAGC,MACvD,MAAOD,KAAOF,QAAQrB,SAAUuB,GAAI,CACnC,GAAIF,QAAQE,IAAIE,SAAW,MAAO,CAAED,MAAMzB,KAASE,GAAI,CAAG,UAC1D,GAAIF,EAAI,EAAG,QACX,IAAI2B,UAAWL,QAAQE,IAAIE,OAAOH,MAAM,IACxC,IAAIK,MAAOD,SAAS,GAAIE,MAAQF,SAAS,KACvCH,EACF,IAAIhC,MAAO8B,QAAQE,IAAIE,MACvB,SAASE,MACR,KAAM,EACL,GAAIpC,OAAS,MAAO,CAAEiC,MAAMzB,KAASE,GAAI,CAAG,cACvC,IAAIV,OAAS,MAAO,KAAM,IAAI2B,OAAM,oCAAsC3B,KAC/E,MACD,KAAK,GACJ,GAAGA,OAAS,OAAQiC,IAAIzB,GAAGE,GAAK,SAC3B,IAAGV,OAAS,QAASiC,IAAIzB,GAAGE,GAAK,UACjC,KAAI2B,QAAUA,MAAOJ,IAAIzB,GAAGE,IAAM2B,UAClCJ,KAAIzB,GAAGE,GAAK2B,QACf3B,CAAG,MACN,KAAK,GACJV,KAAOA,KAAKsC,OAAO,EAAEtC,KAAKS,OAAO,EACjCwB,KAAIzB,GAAGE,KAAOV,OAAS,GAAKA,KAAO,IACnC,OAEF,GAAIA,OAAS,MAAO,MAErB,MAAOiC,KAGR,IAAIM,cAAe,SAAUjB,KAAO,MAAOvB,cAAa8B,WAAWP,MAEnE,IAAIkB,iBAAkB,SAAUlB,KAAO,MAAO5B,mBAAkB6C,aAAajB,MAG7E,IAAImB,aAAc,SAASnB,KAC1B,GAAIQ,SAAUR,IAAIS,MAAM,WAAYvB,GAAK,EAAGE,GAAK,EAAGsB,GAAK,EAAGU,GAAK,EAAGT,MACpE,IAAIU,WACJ,IAAIC,kBAAmB,IACvB,MAAOZ,KAAOF,QAAQrB,SAAUuB,GAAI,CACnC,GAAIa,QAASf,QAAQE,IAAIE,OAAOH,MAAM,IACtC,IAAIe,IAAKD,OAAO,GAAIhE,GACpB,IAAGiE,KAAO,IAAK,IAAIJ,GAAG,EAAGA,GAAGG,OAAOpC,SAAUiC,GAAI,OAAOG,OAAOH,IAAIK,OAAO,IACzE,IAAK,IACJJ,QAAQK,KAAKH,OAAOH,IAAIJ,OAAO,GAC/B,WAEG,IAAGQ,KAAO,KAAOA,KAAO,IAAK,aAC7B,KAAIJ,GAAG,EAAGA,GAAGG,OAAOpC,SAAUiC,GAAI,OAAOG,OAAOH,IAAIK,OAAO,IAC/D,IAAK,IACJvC,EAAIyC,SAASJ,OAAOH,IAAIJ,OAAO,IAAI,CAAG5B,GAAI,CAC1C,KAAI,GAAIwC,GAAIjB,IAAIxB,OAAQyC,GAAK1C,IAAK0C,EAAGjB,IAAIiB,KACzC,MACD,KAAK,IAAKxC,EAAIuC,SAASJ,OAAOH,IAAIJ,OAAO,IAAI,CAAG,MAChD,KAAK,IACJzD,IAAMgE,OAAOH,IAAIJ,OAAO,EACxB,IAAGzD,IAAIkE,OAAO,KAAO,IAAKlE,IAAMA,IAAIyD,OAAO,EAAEzD,IAAI4B,OAAS,OACrD,IAAG5B,MAAQ,OAAQA,IAAM,SACzB,IAAGA,MAAQ,QAASA,IAAM,UAC1B,KAAIA,OAASA,IAAK,CACtBA,KAAOA,GACP,IAAG+D,mBAAqB,MAAQA,iBAAiBO,MAAM,kBAAmBtE,IAAMH,QAAQG,KAEzFoD,IAAIzB,GAAGE,GAAK7B,GACZ+D,kBAAmB,IACnB,MACD,KAAK,IACJ,GAAGE,KAAO,IAAK,KACfF,kBAAmBD,QAAQM,SAASJ,OAAOH,IAAIJ,OAAO,MAGzD,MAAOL,KAGR,IAAImB,eAAgB,SAAS9B,KAAO,MAAOvB,cAAa0C,YAAYnB,MAEpE,IAAI+B,kBAAmB,SAAU/B,KAAO,MAAO5B,mBAAkB0D,cAAc9B,MAG/E,IAAIgC,mBAAoB,SAAShC,KAChC,GAAIQ,SAAUR,IAAIS,MAAM,MAAOvB,GAAK,EAAGE,GAAK,EAAGsB,GAAK,EAAGC,MACvD,MAAOD,KAAOF,QAAQrB,SAAUuB,GAAI,CACnC,GAAIa,QAASf,QAAQE,IAAIE,OAAOH,MAAM,IACtC,IAAGc,OAAO,KAAO,OAAQ,QACzB,IAAIU,MAAOC,YAAYX,OAAO,GAC9B,IAAGZ,IAAIxB,QAAU8C,KAAKjD,EAAG,IAAIE,EAAIyB,IAAIxB,OAAQD,GAAK+C,KAAKjD,IAAKE,EAAG,IAAIyB,IAAIzB,GAAIyB,IAAIzB,KAC/EA,GAAI+C,KAAKjD,CAAGI,GAAI6C,KAAKlD,CACrB,QAAOwC,OAAO,IACb,IAAK,IAAKZ,IAAIzB,GAAGE,GAAKmC,OAAO,EAAI,MACjC,KAAK,IAAKZ,IAAIzB,GAAGE,IAAMmC,OAAO,EAAI,MAClC,KAAK,MAAO,IAAK,MAChB,OAAOA,OAAO,IACb,IAAK,KAAMZ,IAAIzB,GAAGE,IAAMmC,OAAO,GAAK,KAAO,KAAO,MAClD,SAASZ,IAAIzB,GAAGE,IAAMmC,OAAO,EAAI,OAChC,OAGL,MAAOZ,KAGR,IAAIwB,qBAAsB,SAASnC,KAAO,MAAOvB,cAAauD,kBAAkBhC,MAEhF,IAAIoC,wBAAyB,SAAUpC,KAAO,MAAO5B,mBAAkB+D,oBAAoBnC,MAE3F,IAAIqC,aAAc,SAASjC,GAAK,KAAM,IAAIC,OAAM,wBAEhD,IAAIiC,gBAAiB,SAAUtC,KAAO,MAAO5B,mBAAkBiE,YAAYrC,MAE3E,IAAIuC,MAAO,SAAUnC,EAAGzB,KAAM6D,MAC7B,GAAGA,OAAS,MAAQ,MAAOtC,iBAAgBE,EAC3C,IAAGA,EAAEY,OAAO,EAAG,KAAO,SAAWZ,EAAEY,OAAO,EAAG,IAAIyB,QAAQ,QAAU,EAAG,MAAOvB,iBAAgBd,OACxF,IAAGA,EAAEY,OAAO,EAAE,KAAO,KAAM,MAAOe,kBAAiB3B,OACnD,IAAGA,EAAEY,OAAO,EAAE,MAAQ,sBAAuB,MAAOoB,wBAAuBhC,OAC3E,IAAGA,EAAEY,OAAO,EAAE,KAAO,gEAAiE,MAAOsB,gBAAelC,OAC5G,IAAGA,EAAEqC,QAAQ,OAAS,GAAKrC,EAAEqC,QAAQ,OAAU,EAAG,MAAOvC,iBAAgBE,OACzE,OAAOE,iBAAgBF,GAG7B,IAAIsC,UAAW,SAAUtC,EAAGuC,GAC3B,GAAIC,GAAIhG,GAAGiG,aAAazC,EACxB,KAAKwC,EAAE,IAAI,EAAGA,EAAE,KAAK,MAAQ,MAAOL,MAAK7F,QAAQoG,MAAMC,OAAO,KAAMH,EAAEI,MAAM,IAAKL,EAAG,MACpF,OAAOJ,MAAKK,EAAEK,WAAYN,GAE3B,SAASO,YAAWC,QAAU,MAAOxB,UAASwB,OAAO,IAAM,EAC3D,QAASC,YAAWC,KAAO,MAAO,IAAMA,IAAM,GAE9C,QAASC,YAAWC,QAAU,GAAIxE,GAAIwE,OAAQ9F,EAAI,EAAG+F,EAAI,CAAG,MAAMA,IAAMzE,EAAEI,SAAUqE,EAAG/F,EAAI,GAAGA,EAAIsB,EAAE0E,WAAWD,GAAK,EAAI,OAAO/F,GAAI,EACnI,QAASiG,YAAWC,KAAO,GAAI7E,GAAE,EAAI,OAAM6E,IAAKA,IAAKA,IAAIC,KAAKC,OAAOF,IAAI,GAAG,IAAK7E,EAAIgF,OAAOC,cAAeJ,IAAI,GAAG,GAAM,IAAM7E,CAAG,OAAOA,GAExI,QAASkF,YAAWC,MAAQ,MAAOA,MAAKC,QAAQ,sBAAsB,SAASzD,MAAM,KACrF,QAASyB,aAAY+B,MAAQ,GAAIE,MAAOH,WAAWC,KAAO,QAASlF,EAAEuE,WAAWa,KAAK,IAAKnF,EAAEkE,WAAWiB,KAAK,KAC5G,QAAS5E,aAAYF,MAAQ,MAAOqE,YAAWrE,KAAKN,GAAKqE,WAAW/D,KAAKL,GACzE,QAASW,cAAayE,GAAGC,IACxB,SAAUA,MAAO,mBAAsBA,MAAO,SAAU,MAAO1E,cAAayE,GAAGtF,EAAGsF,GAAGnF,EACrF,UAAUmF,MAAO,SAAUA,GAAK7E,YAAY6E,GAAK,UAAUC,MAAO,SAAUA,GAAK9E,YAAY8E,GAC7F,OAAOD,KAAMC,GAAKD,GAAKA,GAAK,IAAMC,GAGnC,GAAIvB,QACHY,WAAYA,WACZN,WAAYA,WACZ7D,YAAaA,YACbI,aAAcA,aACd2D,WAAYI,WACZR,WAAYE,WACZlB,YAAa3C,YAEdpD,MAAKoG,KAAOA,IACZpG,MAAKuG,SAAWA,QAChBvG,MAAK2G,MAAQA,cACHxG,WAAY,YAAcA,QAAUH"}